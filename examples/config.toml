# SandTrace global configuration
# Place at: ~/.sandtrace/config.toml
# Generate defaults with: sandtrace init

# Primary rules directory
rules_dir = "~/.sandtrace/rules"

# Additional rule directories (e.g. community packs)
# Rules from all directories are merged at runtime.
additional_rules = []
# additional_rules = ["~/.sandtrace/community-rules"]

# Default alert channels for watch mode
# Options: "stdout", "desktop", "syslog", "webhook:<url>"
# CLI --alert flags override these.
default_alerts = ["stdout"]

# Redaction markers — lines containing these are skipped during audit.
# Prevents false positives on documentation samples, env var lookups,
# template variables, and dynamic value construction.
redaction_markers = [
  # Explicit redaction
  "_redacted", "-redacted", "redacted_", "redacted-",
  # Documentation placeholders
  "placeholder", "your_token", "your-token",
  "your_key", "your-key", "your_secret", "your-secret",
  "your_password", "your-password",
  "changeme", "replace_me", "replace-me",
  "sample_token", "sample-token", "sample_key", "sample-key",
  "dummy_token", "dummy-token", "fake_token", "fake-token",
  # Placeholder/dummy values
  "your-api", "your_api", "your_access", "your-access",
  "your_bearer", "your-bearer", "key-xxxx", "xxxx",
  # Template variables (Helm, Jinja, env substitution)
  "{{ .", "{{.", "{{ $", "{{$", "${", "$(", "<%=",
  # Dynamic value lookups (not hardcoded)
  "config(", "env(", "getenv(", "process.env",
  "os.environ", "vault.", "ssm.", "secrets.",
  # Logging/debugging (showing truncated values, not hardcoding)
  "log::", "logger.", "console.log", "this->error(", "this->info(",
  "str::take(", "substr(",
  # String concatenation (dynamic values, not hardcoded)
  "'.$", "\".$", "' .", "\" .",
]

# Obfuscation scanner settings
[obfuscation]
# Flag lines with more than this many trailing spaces
max_trailing_spaces = 20
# Flag suspicious content hidden past this column
steganographic_column = 200

# Additional pattern files (merged with custom_patterns below)
# Patterns from these files are appended to custom_patterns at load time.
# pattern_files = ["~/.sandtrace/npm-malware.toml"]

# Custom patterns for audit scanning.
# Supports three match types:
#   "regex"    — pattern is a regular expression (default)
#   "literal"  — pattern is an exact string match (case-insensitive)
#   "filename" — pattern matches against file names/paths
#
# [[custom_patterns]]
# id = "cred-internal-api"
# description = "Internal API key found in source"
# severity = "high"
# pattern = 'INTERNAL_[A-Z0-9]{32}'
#
# # IOC example: known malicious domain
# [[custom_patterns]]
# id = "ioc-c2-domain"
# description = "Known C2 domain found in source"
# severity = "critical"
# match_type = "literal"
# pattern = "malware-c2.example.com"
# tags = ["ioc", "c2"]
#
# # IOC example: malicious file hash
# [[custom_patterns]]
# id = "ioc-malware-hash"
# description = "Known malware SHA256 hash"
# severity = "critical"
# match_type = "literal"
# pattern = "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
# tags = ["ioc", "malware"]
#
# # IOC example: suspicious filename
# [[custom_patterns]]
# id = "ioc-suspicious-file"
# description = "Known malicious filename pattern"
# severity = "high"
# match_type = "filename"
# pattern = "mimikatz"
# file_extensions = ["exe", "dll", "ps1"]
# tags = ["ioc", "tool"]
