# Policy for auditing pnpm install operations
[filesystem]
allow_read = [
    "/usr",
    "/lib",
    "/lib64",
    "/etc/ld.so.cache",
    "/etc/localtime",
    "/etc/resolv.conf",
    "/etc/hosts",
    "/etc/nsswitch.conf",
    "/etc/ssl",
    "/dev/null",
    "/dev/zero",
    "/dev/urandom",
    "/proc/self",
]
allow_write = [
    "./node_modules",
    "./pnpm-lock.yaml",
    "/tmp",
]
allow_exec = [
    "/usr/bin/node",
    "/usr/bin/pnpm",
    "/usr/local/bin/node",
    "/usr/local/bin/pnpm",
]
deny = [
    "/home/*/.ssh",
    "/etc/shadow",
    "/etc/gshadow",
    "**/.env",
    "/root",
    "**/.git/config",
]

[network]
# pnpm needs network to download packages
allow = true

[syscalls]
deny = ["mount", "umount2", "ptrace"]
log_only = ["connect", "bind", "execve"]

[limits]
timeout = 120
