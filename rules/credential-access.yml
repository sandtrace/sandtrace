rules:
  - id: cred-access-aws
    name: AWS Credential File Access
    severity: high
    description: Non-standard process accessing AWS credentials
    detection:
      file_paths:
        - "~/.aws/credentials"
        - "~/.aws/config"
      excluded_processes:
        - aws
        - terraform
        - pulumi
        - cdktf
    alert:
      channels: [stdout, desktop]
      message: "Suspicious access to AWS credentials by {process_name} (PID: {pid})"
    tags: [credential, aws]

  - id: cred-access-ssh
    name: SSH Key Access
    severity: high
    description: Non-standard process accessing SSH keys
    detection:
      file_paths:
        - "~/.ssh/id_*"
        - "~/.ssh/config"
        - "~/.ssh/known_hosts"
      excluded_processes:
        - ssh
        - scp
        - sftp
        - ssh-agent
        - git
    alert:
      channels: [stdout, desktop]
      message: "Suspicious access to SSH keys by {process_name} (PID: {pid})"
    tags: [credential, ssh]

  - id: cred-access-gpg
    name: GPG Keyring Access
    severity: medium
    description: Non-standard process accessing GPG keyring
    detection:
      file_paths:
        - "~/.gnupg/*"
      excluded_processes:
        - gpg
        - gpg2
        - gpg-agent
        - git
    tags: [credential, gpg]

  - id: cred-access-npm
    name: NPM Token Access
    severity: high
    description: Non-standard process accessing npm credentials
    detection:
      file_paths:
        - "~/.npmrc"
        - "~/.config/npm/*"
      excluded_processes:
        - npm
        - npx
        - pnpm
        - yarn
        - node
    tags: [credential, npm]

  - id: cred-access-docker
    name: Docker Config Access
    severity: medium
    description: Non-standard process accessing Docker credentials
    detection:
      file_paths:
        - "~/.docker/config.json"
      excluded_processes:
        - docker
        - dockerd
        - containerd
    tags: [credential, docker]

  - id: cred-access-kube
    name: Kubernetes Config Access
    severity: high
    description: Non-standard process accessing kubeconfig
    detection:
      file_paths:
        - "~/.kube/config"
      excluded_processes:
        - kubectl
        - helm
        - k9s
        - kubectx
    tags: [credential, kubernetes]

  - id: cred-access-gcloud
    name: GCP Credential Access
    severity: high
    description: Non-standard process accessing GCP credentials
    detection:
      file_paths:
        - "~/.config/gcloud/*"
      excluded_processes:
        - gcloud
        - terraform
        - pulumi
    tags: [credential, gcp]

  - id: cred-access-azure
    name: Azure Credential Access
    severity: high
    description: Non-standard process accessing Azure credentials
    detection:
      file_paths:
        - "~/.azure/*"
      excluded_processes:
        - az
        - terraform
        - pulumi
    tags: [credential, azure]
